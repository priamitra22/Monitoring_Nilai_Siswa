<div class="semester-section">
  <div class="semester-header">
    <div class="semester-info-item">
      <span class="semester-info-label">Tahun Ajaran:</span>
      <%= item.tahun_ajaran %>
    </div>
    <div class="semester-info-item">
      <span class="semester-info-label">Semester:</span>
      <%= item.semester %>
    </div>
    <div class="semester-info-item">
      <span class="semester-info-label">Kelas:</span>
      <%= item.kelas %>
    </div>
  </div>

  <div class="section-content">
    <div class="section-title">Nilai Akademik</div>
    <table class="table table-nilai">
      <thead>
        <tr>
          <th style="width: 5%; text-align: center;">No</th>
          <th style="width: 40%">Mata Pelajaran</th>
          <th style="width: 15%; text-align: center;">Nilai Akhir</th>
          <th style="width: 10%; text-align: center;">Predikat</th>
          <th style="width: 30%">Guru Pengajar</th>
        </tr>
      </thead>
      <tbody>
        <% if (item.nilai && item.nilai.length) { %>
          <% item.nilai.forEach(function(n, idx) { %>
            <tr>
              <td style="text-align: center">
                <%= idx + 1 %>
              </td>
              <td>
                <%= n.nama_mapel %>
              </td>
              <td style="text-align: center; font-weight: bold;">
                <%= n.nilai_akhir %>
              </td>
              <td style="text-align: center">
                <% if(n.grade) { %>
                  <span
                    class="badge-kategori <%= (n.grade === 'A' || n.grade === 'B') ? 'positif' : (n.grade === 'C' ? 'netral' : 'negatif') %>">
                    <%= n.grade %>
                  </span>
                  <% } else { %> - <% } %>
              </td>
              <td>
                <%= n.guru_nama || '-' %>
              </td>
            </tr>
            <% }) %>
              <% } else { %>
                <tr>
                  <td colspan="5" class="text-center catatan-empty">Belum ada data nilai.</td>
                </tr>
                <% } %>
      </tbody>
    </table>

    <div class="section-title" style="margin-top: 20px;">Rekap Kehadiran</div>
    <div class="absensi-box">
      <div class="absensi-grid">
        <div class="absensi-item">
          <span class="absensi-label">Sakit:</span>
          <span class="absensi-value">
            <%= item.absensi.sakit || 0 %>
          </span>
          <span style="margin-left: 4px">hari</span>
        </div>
        <div class="absensi-item">
          <span class="absensi-label">Izin:</span>
          <span class="absensi-value">
            <%= item.absensi.izin || 0 %>
          </span>
          <span style="margin-left: 4px">hari</span>
        </div>
        <div class="absensi-item">
          <span class="absensi-label">Tanpa Keterangan:</span>
          <span class="absensi-value">
            <%= item.absensi.alpha || 0 %>
          </span>
          <span style="margin-left: 4px">hari</span>
        </div>
        <div class="absensi-item" style="margin-left: auto; border-left: 1px solid #cbd5e1; padding-left: 16px;">
          <span class="absensi-label">Total Hadir:</span>
          <span class="absensi-value" style="color: #15803d;">
            <%= item.absensi.hadir || 0 %>
          </span>
          <span style="margin-left: 4px">hari</span>
        </div>
      </div>
    </div>

    <% if (item.catatan && item.catatan.length) { %>
      <div class="section-title" style="margin-top: 20px;">Catatan Siswa</div>
      <table class="table">
        <thead>
          <tr>
            <th style="width: 5%; text-align: center;">No</th>
            <th style="width: 20%">Kategori</th>
            <th style="width: 45%">Catatan</th>
            <th style="width: 30%">Guru / Mapel</th>
          </tr>
        </thead>
        <tbody>
          <% item.catatan.forEach(function(c, idx) { const kat=(c.kategori || '' ).toLowerCase(); %>
            <tr>
              <td style="text-align: center">
                <%= idx + 1 %>
              </td>
              <td>
                <span class="badge-kategori <%= kat %>">
                  <%= c.kategori %>
                </span>
                <div style="font-size: 8pt; color: #6b7280; margin-top: 2px;">
                  <%= c.jenis %>
                </div>
              </td>
              <td>
                <%= c.pesan %>
              </td>
              <td>
                <div style="font-weight: 500;">
                  <%= c.guru_nama || '-' %>
                </div>
                <div style="font-size: 8pt; color: #6b7280;">
                  <%= c.mapel || '-' %>
                </div>
              </td>
            </tr>
            <% }) %>
        </tbody>
      </table>
      <% } %>
  </div>
</div>